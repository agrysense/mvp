/**
 * Test suite of the FarmhoseControoler class.
 * Note: avoid doing lengthy tests (split them in multiple scripts if this is the case)
 */

var jasmine = require("/tests/modules/jasmine/boot");
var farmManagerModule = require("/agApps/ppf/ppfServer/entities/farms/farmManager");
var init = require("./init");

var farmManager = null; // farmManager instance under testing
var farm = null;

jasmine.describe("Testing the Controller class", function() {

    jasmine.beforeAll(function(){
		farmManager = new farmManagerModule.FarmManager();
    }); 

    jasmine.beforeEach(function() {		
        farm = createFarm();
    });

    jasmine.it("controller.listFarms() returns an array of 1 Farm instance", function() {

        try {

            var list = farmManager.listFarms();
            jasmine.expect(list).not.toBeNull(null);
            jasmine.expect(list.length).toBe(1);
            jasmine.expect(list[0].constructor.name).toBe("Farm");
            jasmine.expect(list[0].key).toBe(farm.key);
        }catch(exception){
            throw(JSON.stringify(exception));
        }
    });   

    jasmine.afterAll(function(){        
        init.cleanup();
    });
});

jasmine.execute();